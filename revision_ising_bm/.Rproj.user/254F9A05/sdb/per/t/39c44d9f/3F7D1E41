{
    "collab_server" : "",
    "contents" : "rm(list=ls())\nlibrary(coda)\nlibrary(ergm)\nlibrary(Rcpp)\nlibrary(RcppArmadillo)\nlibrary(MASS)\nlibrary(snow)\nlibrary(doParallel)\nlibrary(foreach)\nSys.setenv(\"PKG_CXXFLAGS\"=\"-fopenmp\")\nSys.setenv(\"PKG_LIBS\"=\"-fopenmp\")\n\n\nset.seed(123)\n#======================================================================\n# Call data and functions\n#======================================================================\n# load(\"simzLiangIn1.RData\")\n# load(\"simzLiangIn1_thin.RData\")\nload(\"simzLiangIn1_long.RData\")\nsourceCpp(\"RcppFtns.cpp\")\n\n\n\n#======================================================================\n# Approximate IKSD\n#======================================================================\nz2 = z[,2]; rm(z, timez)\n\n\nc = 1\nbeta = -1/2\nregint = seq(1000, length(Liang), by = 100)\nidx = sapply(regint, function(i) which(Liang[i] == th))\n\n\n### set up for parallelization\nnprocs = 19\nmp_type = \"MPI\"\n# mp_type = \"PSOCK\"\ncl = parallel::makeCluster(nprocs, type=mp_type)\ndoParallel::registerDoParallel(cl)\n\n\nptm = proc.time()[3]\naiksd = foreach(m = 1:length(idx), .combine = 'c', .packages = \"Rcpp\", .noexport = c(\"W2\", \"pW2\")) %dopar% {\n  sourceCpp(\"RcppFtns.cpp\")\n  \n  k = idx[m]\n  n = regint[m]\n  qn = sapply(1:k, function(i) sum(th[i]==Liang[1:n])/n)\n  \n  wsq = pW2(matrix(th, ncol=1), Sx, matrix(z2, ncol=1), qn, c, beta, k, 1)\n  sqrt(sum(wsq))\n}\ntimeaiksd = proc.time()[3] - ptm\n# save(regint, aiksd, timeaiksd, file = \"simAIKSDLiangIn1.RData\")\n# save(regint, aiksd, timeaiksd, file = \"simAIKSDLiangIn1_thin.RData\")\nsave(regint, aiksd, timeaiksd, file = \"simAIKSDLiangIn1_long.RData\")\n\n",
    "created" : 1604427108822.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3076727708",
    "id" : "3F7D1E41",
    "lastKnownWriteTime" : 1604427115,
    "last_content_update" : 1604427115656,
    "path" : "/storage/work/b/bxk487/diagnostics/ising/ksdLiangIn1.R",
    "project_path" : "ksdLiangIn1.R",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}