{
    "collab_server" : "",
    "contents" : "rm(list=ls())\nlibrary(snow)\nlibrary(doParallel)\nlibrary(foreach)\nlibrary(Rcpp)\nlibrary(RcppArmadillo)\nlibrary(MASS)\nSys.setenv(\"PKG_CXXFLAGS\"=\"-fopenmp\")\nSys.setenv(\"PKG_LIBS\"=\"-fopenmp\")\n\nset.seed(123)\n#======================================================================\n# Call data and functions\n#================================================================\nsourceCpp(\"RcppFtns.cpp\")\n\n\n\n#======================================================================\n# Diagnostic quantity\n#======================================================================\nNin = c(1, 3, 5, 10, 30, 50, 70, 100)\n\n\n### set up for parallelization\nnprocs = 19\nmp_type = \"MPI\"\n# mp_type = \"PSOCK\"\ncl = parallel::makeCluster(nprocs, type=mp_type)\ndoParallel::registerDoParallel(cl)\n\n\n\nfor(k in Nin){\n  \n  # load(paste(\"simzLiangIn\", k, \".RData\", sep = \"\"))\n  # load(paste(\"simzLiangIn\", k, \"_thin.RData\", sep = \"\"))\n  load(paste(\"simzLiangIn\", k, \"_long.RData\", sep = \"\"))\n  \n  regint = seq(1000, length(Liang), by = 100)\n  idx = sapply(regint, function(i) which(Liang[i] == th))\n  \n  ptm = proc.time()[3]\n  bart = foreach(j = idx, .combine = 'c') %dopar% {\n    \n    m = which(idx == j)\n    n = regint[m]\n    qn = sapply(1:j, function(i) sum(th[i]==Liang[1:n])/n)\n    \n    # I Tilde\n    Ihat = sum((z[1:j,1] - (z[1:j,2])^2)*qn)\n    \n    # J Tilde\n    Uhat = sapply(1:j, function(ell) Sx - z[ell,2])\n    Jhat = sum((Uhat^2)*qn)\n    \n    sqrt((Ihat/Jhat - 1)^2)\n  }\n  timebart = proc.time()[3] - ptm\n  \n  # save(regint, bart, file = paste(\"simB2LiangIn\", k, \".RData\", sep = \"\"))\n  # save(regint, bart, file = paste(\"simB2LiangIn\", k, \"_thin.RData\", sep = \"\"))\n  save(regint, bart, file = paste(\"simB2LiangIn\", k, \"_long.RData\", sep = \"\"))\n  \n}\n\n\n\n\n",
    "created" : 1605579083357.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2013667797",
    "id" : "C081273C",
    "lastKnownWriteTime" : 1604899804,
    "last_content_update" : 1604899804,
    "path" : "~/work/diagnostics/ising/b2Liang.R",
    "project_path" : "b2Liang.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}