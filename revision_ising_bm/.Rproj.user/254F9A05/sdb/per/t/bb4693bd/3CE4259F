{
    "collab_server" : "",
    "contents" : "rm(list=ls())\n\n### Second Bartlett --------------------------------------------------------------------\nrm(list=ls())\n# load(\"bartLiang020Perf.RData\")\n# load(\"bartLiang020n30Perf.RData\")\nload(\"bartLiang020n30Perf_long.RData\")\n\n\n\nNin = c(1, 3, 5, 10, 30, 50, 70, 100)\nylimit = c(0, max(unlist(bartLiang)))\nburn = 10000\n\npar(mfrow=c(1, 1), mar = c(3.5, 3, 1, 1))\nplot(burn+regint, bartLiang[[1]], type = \"l\", col = 1, ylim = ylimit, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(Nin)){\n  lines(burn+regint, bartLiang[[k]], col = k)\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Iteration\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"B2\",side=2,line=2,las=0,outer=F,cex=0.8)\n# mtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\nlegend('right', col = 1:length(Nin), lty = 1, cex = 0.8, \n       legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\n\n\n\n\n### Second Bartlett for thinned samples -------------------------------------------------\nrm(list=ls())\nload(\"bartLiang020n30Perf_thin.RData\")\n\n\nNin = c(1, 3, 5, 10, 30, 50, 70, 100)\nylimit = c(0, max(unlist(bartLiang)))\n\npar(mfrow=c(1, 1), mar = c(3.5, 3, 1, 1))\nplot(regint, bartLiang[[1]], type = \"l\", col = 1, ylim = ylimit, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(Nin)){\n  lines(regint, bartLiang[[k]], type = \"l\", col = k, ylim = ylimit, ylab = \"\", xlab = \"\", main = \"\")\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Number of thinned sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"B2\",side=2,line=2,las=0,outer=F,cex=0.8)\n# mtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\nlegend('right', col = 1:length(Nin), lty = 1, cex = 0.8, \n       legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\n\n\n\n\n### Approximate IMQ KSD  ----------------------------------------------------------------\nrm(list=ls())\n\n# load(\"aiksdLiang020In1Perf.RData\")\n# load(\"aiksdLiang020In3Perf.RData\")\n# load(\"aiksdLiang020In5Perf.RData\")\n# load(\"aiksdLiang020In10Perf.RData\")\n# load(\"aiksdLiang020In30Perf.RData\")\n# load(\"aiksdLiang020In50Perf.RData\")\n# load(\"aiksdLiang020In70Perf.RData\")\n# load(\"aiksdLiang020In100Perf.RData\")\n# load(\"aiksdLiang020In1000Perf.RData\")\n# load(\"aiksdMurray020Perf.RData\")\n\nload(\"aiksdLiang020n30In1Perf.RData\")\nload(\"aiksdLiang020n30In3Perf.RData\")\nload(\"aiksdLiang020n30In5Perf.RData\")\nload(\"aiksdLiang020n30In10Perf.RData\")\nload(\"aiksdLiang020n30In30Perf.RData\")\nload(\"aiksdLiang020n30In50Perf.RData\")\nload(\"aiksdLiang020n30In70Perf.RData\")\nload(\"aiksdLiang020n30In100Perf.RData\")\n# load(\"aiksdLiang020n30In1000Perf.RData\")\n# load(\"aiksdMurray020n30Perf.RData\")\nload(\"aiksdBesag020n30Perf.RData\")\n\n# aiksd = list(aIKSDLiangIn1, aIKSDLiangIn3, aIKSDLiangIn5, aIKSDLiangIn10, aIKSDLiangIn30, aIKSDLiangIn50, aIKSDLiangIn70, aIKSDLiangIn100, aIKSDLiangIn1000)\n# Nin = c(1, 3, 5, 10, 30, 50, 70, 100, 1000)\n# ylimit = c(0, max(c(unlist(aiksd), aIKSDMurray)))\n\naiksd = list(aIKSDLiangIn1, aIKSDLiangIn3, aIKSDLiangIn5, aIKSDLiangIn30, aIKSDLiangIn50, aIKSDLiangIn70, aIKSDLiangIn100)\nNin = c(1, 3, 5, 30, 50, 70, 100)\nylimit = c(0, max(c(unlist(aiksd), aIKSDBesag)))\nburn = 10000\n\n\npar(mfrow=c(1, 2), mar = c(3.5, 3, 2, 1))\nplot(burn+regint, aiksd[[1]], type = \"l\", col = 1, lty = 2, ylim = ylimit, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(aiksd)){\n  lines(burn+regint, aiksd[[k]], col = k)\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Iteration\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Approximate IKSD\",side=2,line=2,las=0,outer=F,cex=0.8)\nmtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\nlegend('topright', col = 1:length(aiksd), lty = c(2, rep(1, length(Nin)-1)), cex = 0.8, \n       legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\n\nplot(burn+regint, aIKSDBesag, ylim = ylimit, type = \"l\", ylab = \"\", xlab = \"\", main = \"\")\nmtext(text=\"Iteration\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Approximate IKSD\",side=2,line=2,las=0,outer=F,cex=0.8)\nmtext(text=\"Psedolikelihood MH\",side=3,line=0.3,las=1,outer=F,cex=1)\n# legend('topright', col = 1, lty = 1, cex = 0.8, legend = \"Murray's exchange\")\n\n\n\n\n\n### Approximate IMQ KSD for thinned samples  --------------------------------------------------\nrm(list=ls())\n\nload(\"aiksdLiang020n30In1Perf_thin.RData\")\nload(\"aiksdLiang020n30In3Perf_thin.RData\")\nload(\"aiksdLiang020n30In5Perf_thin.RData\")\nload(\"aiksdLiang020n30In10Perf_thin.RData\")\nload(\"aiksdLiang020n30In30Perf_thin.RData\")\nload(\"aiksdLiang020n30In50Perf_thin.RData\")\nload(\"aiksdLiang020n30In70Perf_thin.RData\")\nload(\"aiksdLiang020n30In100Perf_thin.RData\")\n\n\naiksd = list(aIKSDLiangIn1, aIKSDLiangIn3, aIKSDLiangIn5, aIKSDLiangIn30, aIKSDLiangIn50, aIKSDLiangIn70, aIKSDLiangIn100)\nNin = c(1, 3, 5, 30, 50, 70, 100)\nylimit = c(0, max(unlist(aiksd)))\n\n\npar(mfrow=c(1, 1), mar = c(3.5, 3, 2, 1))\nplot(regint, aiksd[[1]], type = \"l\", col = 1, lty = 1, ylim = ylimit, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(aiksd)){\n  lines(regint, aiksd[[k]], col = k)\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Number of thinned sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Approximate IKSD\",side=2,line=2,las=0,outer=F,cex=0.8)\nmtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\nlegend('topright', col = 1:length(aiksd), lty = 1, cex = 0.8, \n       legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\n\n\n\n\n\n### AIKSD for thinned samples from DMH and Murray --------------------------------\nrm(list=ls())\nload(\"aiksdLiang020In3Perf_thin.RData\")\nload(\"aiksdLiang020In10Perf_thin.RData\")\nload(\"aiksdLiang020In50Perf_thin.RData\")\nregintLiang = regint\nload(\"aiksdMurray020Perf_thin.RData\")\n\naiksdLiang = list(aIKSDLiangIn3, aIKSDLiangIn10, aIKSDLiangIn50)\nNin = c(3, 10, 50)\n# aiksdLiang = list(aIKSDLiangIn3, aIKSDLiangIn50)\n# Nin = c(3, 50)\nburn = 10000\n# ylimit = c(0, max(c(unlist(aiksdLiang), aIKSDMurray)))\nylimit = c(0, 1)\n\npar(mfrow=c(1, 2), mar = c(3.5, 3, 2, 1))\nplot(regintLiang, aiksdLiang[[1]], type = \"l\", col = 1, ylim = ylimit, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(Nin)){\n  lines(regintLiang, aiksdLiang[[k]], col = k)\n}\nmtext(text=\"Number of sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Approximate IKSD\",side=2,line=2,las=0,outer=F,cex=0.8)\nmtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\nlegend('topright', col = 1:length(Nin), lty = 1, cex = 0.8, \n       legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\n\nplot(regint, aIKSDMurray, ylim = ylimit, type = \"l\", ylab = \"\", xlab = \"\", main = \"\")\nmtext(text=\"Number of sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Approximate IKSD\",side=2,line=2,las=0,outer=F,cex=0.8)\nmtext(text=\"Murray's Exchange\",side=3,line=0.3,las=1,outer=F,cex=1)\n# legend('topright', col = 1, lty = 1, cex = 0.8, legend = \"Murray's exchange\")\n\n\n\n\n\n\n\n### comparison between B2 and AIKSD ------------------------------------------------------\nrm(list=ls())\n# load(\"bartLiang020Perf.RData\")\n# load(\"aiksdLiang020In1Perf.RData\")\n# load(\"aiksdLiang020In3Perf.RData\")\n# load(\"aiksdLiang020In5Perf.RData\")\n# load(\"aiksdLiang020In10Perf.RData\")\n# load(\"aiksdLiang020In30Perf.RData\")\n# load(\"aiksdLiang020In50Perf.RData\")\n# load(\"aiksdLiang020In70Perf.RData\")\n# load(\"aiksdLiang020In100Perf.RData\")\n\n\nload(\"bartLiang020n30Perf.RData\")\nload(\"bartBesag020n30Perf.RData\")\n\nload(\"aiksdLiang020n30In1Perf.RData\")\nload(\"aiksdLiang020n30In3Perf.RData\")\nload(\"aiksdLiang020n30In5Perf.RData\")\nload(\"aiksdLiang020n30In10Perf.RData\")\nload(\"aiksdLiang020n30In30Perf.RData\")\nload(\"aiksdLiang020n30In50Perf.RData\")\nload(\"aiksdLiang020n30In70Perf.RData\")\nload(\"aiksdLiang020n30In100Perf.RData\")\nload(\"aiksdBesag020n30Perf.RData\")\n\n\nNin = c(1, 3, 5, 10, 30, 50, 70, 100)\naiksd = list(aIKSDLiangIn1, aIKSDLiangIn3, aIKSDLiangIn5, aIKSDLiangIn10, aIKSDLiangIn30, aIKSDLiangIn50, aIKSDLiangIn70, aIKSDLiangIn100)\n# ylimitbart = c(0, max(unlist(bartLiang)))\n# ylimitaiksd = c(0, max(unlist(aiksd)))\nylimitbart = c(0, max(c(unlist(bartLiang), bartBesag)))\nylimitaiksd = c(0, max(c(unlist(aiksd), aIKSDBesag)))\nburn = 10000\n\npar(mfrow=c(1, 2), mar = c(3.5, 3, 1, 1))\n# plot(burn+regint, bartLiang[[1]], type = \"l\", col = 1, ylim = ylimitbart, ylab = \"\", xlab = \"\", main = \"\")\n# for(k in 2:length(Nin)){\n#   lines(burn+regint, bartLiang[[k]], col = k)\n# }\nplot(burn+regint, bartBesag, type = \"l\", col = 1, lty = 2, ylim = ylimitbart, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 1:length(Nin)){\n  lines(burn+regint, bartLiang[[k]], col = k)\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Iteration\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"B2\",side=2,line=2,las=0,outer=F,cex=0.8)\n# mtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\n# legend('right', col = 1:length(Nin), lty = 1, cex = 0.8, \n#        legend = sapply(Nin, function(i) paste(\"DMH with m = \", i, sep = \"\")))\nlegend('topright', col = c(1, 1:length(Nin)), lty = c(2, rep(1, length(Nin))), cex = 0.6, \n       legend = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH w/ m = \", i, sep = \"\"))))\n\n\n\n# plot(burn+regint, aiksd[[1]], type = \"l\", col = 1, lty = 1, ylim = ylimitaiksd, ylab = \"\", xlab = \"\", main = \"\")\n# for(k in 2:length(aiksd)){\n#   lines(burn+regint, aiksd[[k]], col = k)\n# }\nplot(burn+regint, aIKSDBesag, type = \"l\", col = 1, lty = 2, ylim = ylimitaiksd, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 1:length(aiksd)){\n  lines(burn+regint, aiksd[[k]], col = k)\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Iteration\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Approximate IKSD\",side=2,line=2,las=0,outer=F,cex=0.8)\n# mtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\n# legend('topright', col = 1:length(aiksd), lty = 1, cex = 0.8, \n#        legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\nlegend('right', col = c(1, 1:length(Nin)), lty = c(2, rep(1, length(Nin))), cex = 0.6, \n       legend = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH w/ m = \", i, sep = \"\"))))\n\n\n\n\n\n\n### comparison between B2 and AIKSD for thinned sample ---------------------------------\nrm(list=ls())\n# load(\"bartLiang020Perf_thin.RData\")\n# load(\"aiksdLiang020In3Perf_thin.RData\")\n# load(\"aiksdLiang020In10Perf_thin.RData\")\n# load(\"aiksdLiang020In50Perf_thin.RData\")\n\nload(\"bartLiang020n30Perf_thin.RData\")\nload(\"bartBesag020n30Perf_thin.RData\")\n\nload(\"aiksdLiang020n30In1Perf_thin.RData\")\nload(\"aiksdLiang020n30In3Perf_thin.RData\")\nload(\"aiksdLiang020n30In5Perf_thin.RData\")\nload(\"aiksdLiang020n30In10Perf_thin.RData\")\nload(\"aiksdLiang020n30In30Perf_thin.RData\")\nload(\"aiksdLiang020n30In50Perf_thin.RData\")\nload(\"aiksdLiang020n30In70Perf_thin.RData\")\nload(\"aiksdLiang020n30In100Perf_thin.RData\")\nload(\"aiksdBesag020n30Perf_thin.RData\")\n\n\nNin = c(1, 3, 5, 10, 30, 50, 70, 100)\naiksd = list(aIKSDLiangIn1, aIKSDLiangIn3, aIKSDLiangIn5, aIKSDLiangIn10, aIKSDLiangIn30, aIKSDLiangIn50, aIKSDLiangIn70, aIKSDLiangIn100)\n# ylimitbart = c(0, max(unlist(bartLiang)))\n# ylimitaiksd = c(0, max(unlist(aiksd)))\nylimitbart = c(0, max(c(unlist(bartLiang), bartBesag)))\nylimitaiksd = c(0, max(c(unlist(aiksd), aIKSDBesag)))\n\n\n\npar(mfrow=c(1, 2), mar = c(4.5, 3, 1, 1))\n# plot(regint, bartLiang[[1]], type = \"l\", col = 1, ylim = ylimitbart, ylab = \"\", xlab = \"\", main = \"\")\n# for(k in 2:length(Nin)){\n#   lines(regint, bartLiang[[k]], col = k)\n# }\nplot(regint, bartBesag, type = \"l\", col = 1, lty = 2, ylim = ylimitbart, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 1:length(Nin)){\n  lines(regint, bartLiang[[k]], col = k)\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Number of thinned sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"(Every 50th poitns out of 1,000,000 points)\",side=1,line=3,las=1,outer=F,cex=0.8)\nmtext(text=\"B2\",side=2,line=2,las=0,outer=F,cex=0.8)\n# mtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\n# legend('right', col = 1:length(Nin), lty = 1, cex = 0.8, \n#        legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\nlegend('right', col = c(1, 1:length(Nin)), lty = c(2, rep(1, length(Nin))), cex = 0.7, \n       legend = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH (m = \", i, \")\", sep = \"\"))))\n\n\n# plot(regint, aiksd[[1]], type = \"l\", col = 1, lty = 1, ylim = ylimitaiksd, ylab = \"\", xlab = \"\", main = \"\")\n# for(k in 2:length(aiksd)){\n#   lines(regint, aiksd[[k]], col = k)\n# }\nplot(regint, aIKSDBesag, type = \"l\", col = 1, lty = 2, ylim = ylimitaiksd, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 1:length(aiksd)){\n  lines(regint, aiksd[[k]], col = k)\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Number of thinned sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"(Every 50th poitns out of 1,000,000 points)\",side=1,line=3,las=1,outer=F,cex=0.8)\nmtext(text=\"Approximate IKSD\",side=2,line=2,las=0,outer=F,cex=0.8)\n# mtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\n# legend('topright', col = 1:length(aiksdLiang), lty = 1, cex = 0.8, \n#        legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\n# legend('right', col = c(1, 1:length(Nin)), lty = c(2, rep(1, length(Nin))), cex = 0.7, \n#        legend = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH (m = \", i, \")\", sep = \"\"))))\n\n\n\n\n\n\n\n\n### AIKSD and AGSD ----------------------------------------------------------------\nrm(list=ls())\n\nload(\"aiksdLiang020n30In1Perf.RData\")\nload(\"aiksdLiang020n30In50Perf.RData\")\nregintaiksd = regint\nload(\"~/work/approxStein/ising/sdLiang020n30In1Perf.RData\")\nload(\"~/work/approxStein/ising/sdLiang020n30In50Perf.RData\")\nregintagsd = regint\naiksd = list(aIKSDLiangIn1, aIKSDLiangIn50)\nagsd = list(sdLiangIn1, sdLiangIn50)\nNin = c(1, 50)\nylimit = c(0, max(c(unlist(aiksd), unlist(agsd))))\nburn = 10000\n\npar(mfrow=c(1, 2), mar = c(3.5, 3, 2, 1))\nplot(burn+regintaiksd, aiksd[[1]], type = \"l\", col = 1, lty = 1, ylim = ylimit, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(aiksd)){\n  lines(burn+regintaiksd, aiksd[[k]], col = k)\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Iteration\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Approximate IKSD\",side=2,line=2,las=0,outer=F,cex=0.8)\nmtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\nlegend('topright', col = 1:length(aiksd), lty = 1, cex = 0.8, \n       legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\n\nplot(burn+regintagsd, agsd[[1]], ylim = ylimit, type = \"l\", ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(agsd)){\n  lines(burn+regintagsd, agsd[[k]], col = k)\n}\nmtext(text=\"Iteration\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Approximate GSD\",side=2,line=2,las=0,outer=F,cex=0.8)\nmtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\nlegend('topright', col = 1:length(agsd), lty = 1, cex = 0.8, \n       legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\n\n\n\n\n\n\n### density plots ---------------------------------------------------------\nrm(list=ls())\nload(\"Liang020n30.RData\")\nload(\"Besag020n30.RData\")\n\n\nburn = 10000\nniter = 50000\nLiang = sapply(1:length(Liang), function(i) Liang[[i]][(burn+1):niter], simplify = F)\nBesag = Besag[(burn+1):niter]\n\npar(mfrow=c(1, 1), mar = c(3.5, 3, 1, 1))\n# plot(density(Liang[[1]]), xlab = \"\", ylab = \"\", main = \"\", ylim = c(0, 20))\n# for(i in 2:length(Liang)){\n#   lines(density(Liang[[i]]), col = i)\n# }\nplot(density(Besag), lty = 2, xlab = \"\", ylab = \"\", main = \"\", ylim = c(0, 23))\nfor(i in 1:length(Liang)){\n  lines(density(Liang[[i]]), col = i)\n}\nmtext(text=\"Sample of length 40,000\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Density\",side=2,line=2,las=0,outer=F,cex=0.8)\n# mtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\n# legend('topright', col = 1:length(Nin), lty = 1, cex = 0.8, \n#        legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\nlegend('topright', col = c(1, 1:length(Nin)), lty = c(2, rep(1, length(Nin))), cex = 0.8, \n       legend = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH w/ m = \", i, sep = \"\"))))\n\n\n\n\n### density plots for thinned sample ---------------------------------\nrm(list=ls())\nload(\"Liang020n30.RData\")\nload(\"Besag020n30.RData\")\n\nburn = 10000\nniter = nrow(Liang[[1]])\nLiang = sapply(1:length(Liang), function(i) Liang[[i]][seq(burn+50, niter, by = 50)], simplify = F)\nBesag = Besag[seq(burn+50, niter, by = 50)]\n\npar(mfrow=c(1, 1), mar = c(3.5, 3, 1, 1))\n# plot(density(Liang[[1]]), xlab = \"\", ylab = \"\", main = \"\", ylim = c(0, 20))\n# for(i in 2:length(Liang)){\n#   lines(density(Liang[[i]]), col = i)\n# }\nplot(density(Besag), lty = 2, xlab = \"\", ylab = \"\", main = \"\", ylim = c(0, 23))\nfor(i in 1:length(Liang)){\n  lines(density(Liang[[i]]), col = i)\n}\nmtext(text=\"Thinned sample of length 20,000\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Density\",side=2,line=2,las=0,outer=F,cex=0.8)\n# mtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\n# legend('topright', col = 1:length(Nin), lty = 1, cex = 0.8, \n#        legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\nlegend('topright', col = c(1, 1:length(Nin)), lty = c(2, rep(1, length(Nin))), cex = 0.8, \n       legend = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH w/ m = \", i, sep = \"\"))))\n\n\n\n# tail probabilities\na = quantile(Liang[[length(Liang)]], probs = 0.025)\nb = quantile(Liang[[length(Liang)]], probs = 0.975)\n\npar(mfrow=c(1, 1), mar = c(3.5, 3, 1, 1))\nplot(density(Besag), lty = 2, xlab = \"\", ylab = \"\", main = \"\", ylim = c(0, 23))\nfor(i in 1:length(Liang)){\n  lines(density(Liang[[i]]), col = i)\n}\nabline(v = a, lty = 3)\nabline(v = b, lty = 3)\nmtext(text=\"Thinned sample of length 20,000\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Density\",side=2,line=2,las=0,outer=F,cex=0.8)\nlegend('topright', col = c(1, 1:length(Nin)), lty = c(2, rep(1, length(Nin))), cex = 0.8, \n       legend = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH w/ m = \", i, sep = \"\"))))\n\n\nltpLiang = sapply(1:length(Liang), function(k) sum(Liang[[k]] < a)/length(Liang[[k]]))\nutpLiang = sapply(1:length(Liang), function(k) sum(Liang[[k]] > b)/length(Liang[[k]]))\nltp = round(c(sum(Besag < a)/length(Besag), ltpLiang),4)\nutp = round(c(sum(Besag > b)/length(Besag), utpLiang),4)\ntp = data.frame(rbind(ltp, utp))\ncolnames(tp) = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH(m=\", i, \")\", sep = \"\")))\ntp\n",
    "created" : 1602617564911.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2560186514",
    "id" : "3CE4259F",
    "lastKnownWriteTime" : 1603245448,
    "last_content_update" : 1603245448462,
    "path" : "~/work/approxKSD/ising/plotLiang.R",
    "project_path" : "plotLiang.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}