{
    "collab_server" : "",
    "contents" : "### B2 -------------------------------------------------\nrm(list=ls())\nbartLiang = bartregint = list()\nNin = c(1, 3, 5, 10, 30, 50, 70, 100)\n\nfor(i in 1:length(Nin)){\n  load(paste(\"simB2LiangIn\", Nin[i], \"_long.RData\", sep = \"\"))\n  # load(paste(\"simB2LiangIn\", Nin[i], \"_thin.RData\", sep = \"\"))\n  bartLiang[[i]] = bart\n  bartregint[[i]] = regint\n}\nrm(bart, regint)\n\ncp = which(bartregint[[1]]==70000)\nylimitbart = c(0, max(bartLiang[[1]]))\n\nlayout(matrix(c(1,2), ncol=2), widths = c(0.8,0.2))\npar(mar = c(3.5, 3, 1, 1))\n\nplot(bartregint[[1]][1:cp], bartLiang[[1]][1:cp], type = \"l\", col = 1, ylim = ylimitbart, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(Nin)){\n  lines(bartregint[[k]][1:cp], bartLiang[[k]][1:cp], col = k)\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Number of sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"B2\",side=2,line=2,las=0,outer=F,cex=0.8)\n\n\npar(mar = c(0,0,0,0))\nplot.new()\nlegend('center', col = 1:length(Nin), lty = 1, cex = 0.8, inset=0, \n       legend = sapply(Nin, function(i) paste(\"DMH (m=\", i, \")\", sep = \"\")))\n\n\n\n\n### AIKSD -------------------------------------------------\nrm(list=ls())\naiksdLiang = aiksdregint = list()\nNin = c(1, 3, 5, 10, 30, 50, 70, 100)\n\nfor(i in 1:length(Nin)){\n  load(paste(\"simAIKSDLiangIn\", Nin[i], \"_long.RData\", sep = \"\"))\n  # load(paste(\"simAIKSDLiangIn\", Nin[i], \"_thin.RData\", sep = \"\"))\n  aiksdLiang[[i]] = aiksd\n  aiksdregint[[i]] = regint\n}\nrm(aiksd, regint)\n\nylimitaiksd = c(0, max(unlist(aiksdLiang)))\n\nlayout(matrix(c(1,2), ncol=2), widths = c(0.8,0.2))\npar(mar = c(3.5, 3, 1, 1))\n\n\nplot(aiksdregint[[1]], aiksdLiang[[1]], type = \"l\", col = 1, lty = 1, ylim = ylimitaiksd, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(aiksdLiang)){\n  lines(aiksdregint[[k]], aiksdLiang[[k]], col = k)\n}\nabline(h = 0, lty = \"dashed\")\nmtext(text=\"Number of sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\n# mtext(text=\"Number of thinned sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"AIKSD\",side=2,line=2,las=0,outer=F,cex=0.8)\n\n\npar(mar = c(0,0,0,0))\nplot.new()\nlegend('center', col = 1:length(Nin), lty = 1, cex = 0.8, inset=0, \n       legend = sapply(Nin, function(i) paste(\"DMH (m=\", i, \")\", sep = \"\")))\n\n\n\n\n\n\n\n### B2 and AIKSD -------------------------------------------------\nrm(list=ls())\nbartLiang = bartregint = list()\naiksdLiang = aiksdregint = list()\nNin = c(1, 3, 5, 10, 30, 50, 70, 100)\n\nfor(i in 1:length(Nin)){\n  # load(paste(\"simB2LiangIn\", Nin[i], \"_thin.RData\", sep = \"\"))\n  load(paste(\"simB2LiangIn\", Nin[i], \"_long.RData\", sep = \"\"))\n  cp = which(regint==70000)\n  bartLiang[[i]] = bart[1:cp]\n  bartregint[[i]] = regint[1:cp]\n\n  \n  # load(paste(\"simAIKSDLiangIn\", Nin[i], \"_thin.RData\", sep = \"\"))\n  load(paste(\"simAIKSDLiangIn\", Nin[i], \"_long.RData\", sep = \"\"))\n  cp = which(regint==70000)\n  aiksdLiang[[i]] = aiksd[1:cp]\n  aiksdregint[[i]] = regint[1:cp]\n}\nrm(bart, aiksd, regint)\n\nload(\"simB2Murray_long.RData\")\nbartMurray = bart\nbartregintMurray = regint\nload(\"simAIKSDMurray_long.RData\")\naiksdMurray = aiksd\naiksdregintMurray = regint\n\nload(\"simB2Besag_long.RData\")\nbartBesag = bart[1:which(regint==70000)]\nbartregintBesag = regint[1:which(regint==70000)]\nload(\"simAIKSDBesag_long.RData\")\naiksdBesag = aiksd[1:which(regint==70000)]\naiksdregintBesag = regint[1:which(regint==70000)]\n\n\n\n\n# ylimitbart = c(0, max(bartLiang[[1]]))\n# ylimitaiksd = c(0, max(aiksdLiang[[1]]))\n\n# ylimitbart = c(0, max(unlist(bartLiang)))\n# # ylimitaiksd = c(0, max(unlist(aiksdLiang)))\n# ylimitaiksd = c(0, 1.5)\n\nylimitbart = c(0, max(bartBesag))\nylimitaiksd = c(0, max(aiksdBesag))\n\n\n\nlayout(matrix(c(1,2,3), ncol=3), widths = c(0.43,0.43,0.14))\npar(mar = c(3.5, 3, 1, 1))\n\nplot(bartregint[[1]], bartLiang[[1]], type = \"l\", col = 1, ylim = ylimitbart, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(Nin)){\n  lines(bartregint[[k]], bartLiang[[k]], col = k)\n}\nlines(bartregintMurray, bartMurray, lty = 3, lwd = 2)\nlines(bartregintBesag, bartBesag, lty = 2, lwd = 2)\nabline(h = 0, lty = \"dashed\")\n# mtext(text=\"Number of thinned sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Number of sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"B2\",side=2,line=2,las=0,outer=F,cex=0.8)\n\n\n\nplot(aiksdregint[[1]], aiksdLiang[[1]], type = \"l\", col = 1, lty = 1, ylim = ylimitaiksd, ylab = \"\", xlab = \"\", main = \"\")\nfor(k in 2:length(aiksdLiang)){\n  lines(aiksdregint[[k]], aiksdLiang[[k]], col = k)\n}\nlines(aiksdregintMurray, aiksdMurray, lty = 3, lwd = 2)\nlines(aiksdregintBesag, aiksdBesag, lty = 2, lwd = 2)\nabline(h = 0, lty = \"dashed\")\n# mtext(text=\"Number of thinned sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Number of sample points\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Approximate IKSD\",side=2,line=2,las=0,outer=F,cex=0.8)\n\n\npar(mar = c(0,0,0,0))\nplot.new()\nlegend('center', col = c(1:length(Nin), 1, 1), lty = c(rep(1,length(Nin)), 3, 2), lwd = c(rep(1,length(Nin)), 2, 2), cex = 1, inset=0, \n       legend = c(sapply(Nin, function(i) paste(\"DMH (m=\", i, \")\", sep = \"\")), \"Exchange\", \"Pseudo MH\"))\n\n\n\n\n\n### density plots ---------------------------------------------------------\nrm(list=ls())\nload(\"Liang020n30.RData\")\nload(\"Besag020n30.RData\")\n\n\nburn = 10000\nniter = 50000\nLiang = sapply(1:length(Liang), function(i) Liang[[i]][(burn+1):niter], simplify = F)\nBesag = Besag[(burn+1):niter]\n\npar(mfrow=c(1, 1), mar = c(3.5, 3, 1, 1))\n# plot(density(Liang[[1]]), xlab = \"\", ylab = \"\", main = \"\", ylim = c(0, 20))\n# for(i in 2:length(Liang)){\n#   lines(density(Liang[[i]]), col = i)\n# }\nplot(density(Besag), lty = 2, xlab = \"\", ylab = \"\", main = \"\", ylim = c(0, 23))\nfor(i in 1:length(Liang)){\n  lines(density(Liang[[i]]), col = i)\n}\nmtext(text=\"Sample of length 40,000\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Density\",side=2,line=2,las=0,outer=F,cex=0.8)\n# mtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\n# legend('topright', col = 1:length(Nin), lty = 1, cex = 0.8, \n#        legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\nlegend('topright', col = c(1, 1:length(Nin)), lty = c(2, rep(1, length(Nin))), cex = 0.8, \n       legend = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH w/ m = \", i, sep = \"\"))))\n\n\n\n\n### density plots for thinned sample ---------------------------------\nrm(list=ls())\nload(\"Liang020n30.RData\")\nload(\"Besag020n30.RData\")\n\nburn = 10000\nniter = nrow(Liang[[1]])\nLiang = sapply(1:length(Liang), function(i) Liang[[i]][seq(burn+50, niter, by = 50)], simplify = F)\nBesag = Besag[seq(burn+50, niter, by = 50)]\n\npar(mfrow=c(1, 1), mar = c(3.5, 3, 1, 1))\n# plot(density(Liang[[1]]), xlab = \"\", ylab = \"\", main = \"\", ylim = c(0, 20))\n# for(i in 2:length(Liang)){\n#   lines(density(Liang[[i]]), col = i)\n# }\nplot(density(Besag), lty = 2, xlab = \"\", ylab = \"\", main = \"\", ylim = c(0, 23))\nfor(i in 1:length(Liang)){\n  lines(density(Liang[[i]]), col = i)\n}\nmtext(text=\"Thinned sample of length 20,000\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Density\",side=2,line=2,las=0,outer=F,cex=0.8)\n# mtext(text=\"DMH\",side=3,line=0.3,las=1,outer=F,cex=1)\n# legend('topright', col = 1:length(Nin), lty = 1, cex = 0.8, \n#        legend = sapply(Nin, function(i) paste(\"m = \", i, sep = \"\")))\nlegend('topright', col = c(1, 1:length(Nin)), lty = c(2, rep(1, length(Nin))), cex = 0.8, \n       legend = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH w/ m = \", i, sep = \"\"))))\n\n\n\n# tail probabilities\na = quantile(Liang[[length(Liang)]], probs = 0.025)\nb = quantile(Liang[[length(Liang)]], probs = 0.975)\n\npar(mfrow=c(1, 1), mar = c(3.5, 3, 1, 1))\nplot(density(Besag), lty = 2, xlab = \"\", ylab = \"\", main = \"\", ylim = c(0, 23))\nfor(i in 1:length(Liang)){\n  lines(density(Liang[[i]]), col = i)\n}\nabline(v = a, lty = 3)\nabline(v = b, lty = 3)\nmtext(text=\"Thinned sample of length 20,000\",side=1,line=2.2,las=1,outer=F,cex=0.8)\nmtext(text=\"Density\",side=2,line=2,las=0,outer=F,cex=0.8)\nlegend('topright', col = c(1, 1:length(Nin)), lty = c(2, rep(1, length(Nin))), cex = 0.8, \n       legend = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH w/ m = \", i, sep = \"\"))))\n\n\nltpLiang = sapply(1:length(Liang), function(k) sum(Liang[[k]] < a)/length(Liang[[k]]))\nutpLiang = sapply(1:length(Liang), function(k) sum(Liang[[k]] > b)/length(Liang[[k]]))\nltp = round(c(sum(Besag < a)/length(Besag), ltpLiang),4)\nutp = round(c(sum(Besag > b)/length(Besag), utpLiang),4)\ntp = data.frame(rbind(ltp, utp))\ncolnames(tp) = c(\"PseudoMH\", sapply(Nin, function(i) paste(\"DMH(m=\", i, \")\", sep = \"\")))\ntp\n",
    "created" : 1604425308405.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "705827833",
    "id" : "2F87ED58",
    "lastKnownWriteTime" : 1604949302,
    "last_content_update" : 1604949302771,
    "path" : "~/work/diagnostics/ising/plotLiang.R",
    "project_path" : "plotLiang.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}