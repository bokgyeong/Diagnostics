{
    "collab_server" : "",
    "contents" : "rm(list=ls())\nlibrary(tidyverse)\nlibrary(gridExtra)\nget_legend<-function(myggplot){\n  tmp <- ggplot_gtable(ggplot_build(myggplot))\n  leg <- which(sapply(tmp$grobs, function(x) x$name) == \"guide-box\")\n  legend <- tmp$grobs[[leg]]\n  return(legend)\n}\n\n# ===================================================\n# Data preparation for B2 and AIKSD\n# ===================================================\nd = c(100, 200, 400) # no. of particles\nN = c(500, 1000)     # no. of IS estimates\ntunpar = matrix(c(rep(d, each = length(N)), rep(N, length(d))), ncol = 2)\n\nburnIn = 10000\n\n### B2 ----------------------------------------------\n\nb2 = data.frame()\nfor(i in 1:nrow(tunpar)){\n  load(paste(\"simB2LikEmd\", tunpar[i,1], \"N\", tunpar[i,2], \".RData\", sep = \"\"))\n  df = data.frame(Particle = as.factor(tunpar[i,1]), IS = as.factor(tunpar[i,2]), InvFro = bart[,1], InvMax = bart[,2], InvFroMod = bart[,3], InvMaxMod = bart[,4], DifFro = bart[,5], DifMax = bart[,6], Knots = burnIn + regint[1:nrow(bart)])\n  b2 = rbind(b2, df)\n}\n\n\n\n### AIKSD ----------------------------------------------\naiksd = data.frame()\nfor(i in 1:nrow(tunpar)){\n  load(paste(\"simAIKSDLikEmd\", tunpar[i,1], \"N\", tunpar[i,2], \".RData\", sep = \"\"))\n  df = data.frame(Particle = as.factor(tunpar[i,1]), IS = as.factor(tunpar[i,2]), Values = aiksdLikEm, Knots = burnIn + regint[1:length(aiksdLikEm)])\n  aiksd = rbind(aiksd, df)\n}\n\n\n\n# =========================================================\n# Visualization\n# =========================================================\nylimit = b2 %>%\n  summarise(InvUp = max(InvFro, InvMax), InvModUp = max(InvFroMod, InvMaxMod), DifUp = max(DifFro, DifMax))\nylimit = unlist(ylimit)\n\n# ylimit = c(6, 60)\n\n### B2 - norm of H^{-1}J - I --------------------------------\npInvFro = ggplot(b2, aes(x = Knots, y = InvFro)) +\n  geom_line(aes(color = Particle, linetype = IS)) +\n  coord_cartesian(ylim = c(0, ylimit[1])) +\n  # coord_cartesian(ylim = c(0, NA)) +\n  labs(title = expression(\"A. ||\"*H^-1*J - I*\"||\"[\"F\"]), x = \"The number of sample points\", y = \"Values\")\n\npInvMax = ggplot(b2, aes(x = Knots, y = InvMax)) +\n  geom_line(aes(color = Particle, linetype = IS)) +\n  coord_cartesian(ylim = c(0, ylimit[1])) +\n  # coord_cartesian(ylim = c(0, NA)) +\n  labs(title = expression(\"B. ||\"*H^-1*J - I*\"||\"[\"max\"]), x = \"The number of sample points\", y = \"Values\") +\n  theme(legend.position=\"none\")\n\npDifFro = ggplot(b2, aes(x = Knots, y = DifFro)) +\n  geom_line(aes(color = Particle, linetype = IS)) +\n  coord_cartesian(ylim = c(0, ylimit[3])) +\n  # coord_cartesian(ylim = c(0, NA)) +\n  labs(title = expression(\"E. ||\"*H - J*\"||\"[\"F\"]), x = \"The number of sample points\", y = \"Values\") +\n  theme(legend.position=\"none\")\n\npDifMax = ggplot(b2, aes(x = Knots, y = DifMax)) +\n  geom_line(aes(color = Particle, linetype = IS)) +\n  coord_cartesian(ylim = c(0, ylimit[3])) +\n  # coord_cartesian(ylim = c(0, NA)) +\n  labs(title = expression(\"F. ||\"*H - J*\"||\"[\"max\"]), x = \"The number of sample points\", y = \"Values\") +\n  theme(legend.position=\"none\")\n\n\n### B2 - norm of J^{-1}H - I --------------------------------------\npInvFroMod = ggplot(b2, aes(x = Knots, y = InvFroMod)) +\n  geom_line(aes(color = Particle, linetype = IS)) +\n  coord_cartesian(ylim = c(0, ylimit[2])) +\n  # coord_cartesian(ylim = c(0, NA)) +\n  labs(title = expression(\"C. ||\"*J^-1*H - I*\"||\"[\"F\"]), x = \"The number of sample points\", y = \"Values\") +\n  theme(legend.position=\"none\")\n\npInvMaxMod = ggplot(b2, aes(x = Knots, y = InvMaxMod)) +\n  geom_line(aes(color = Particle, linetype = IS)) +\n  coord_cartesian(ylim = c(0, ylimit[2])) +\n  # coord_cartesian(ylim = c(0, NA)) +\n  labs(title = expression(\"D. ||\"*J^-1*H - I*\"||\"[\"max\"]), x = \"The number of sample points\", y = \"Values\") +\n  theme(legend.position=\"none\")\n\n\n### save the legend\nleg = get_legend(pInvFro)\n\n### Remove the legend\npInvFro = pInvFro + theme(legend.position=\"none\")\n\n### Arrange ggplot2 graphs with a specific width\n# grid.arrange(pInvFro, pInvMax, leg, ncol = 3, widths = c(2.3, 2.3, 1.1))\n# grid.arrange(pDifFro, pDifMax, leg, ncol = 3, widths = c(2.3, 2.3, 1.1))\ngrid.arrange(pInvFro, pInvMax, pDifFro, pDifMax, leg,\n             layout_matrix = matrix(c(1, 2, 5, 3, 4, 5), ncol = 3, byrow = T), widths = c(2.5, 2.5, 1.2))\n\ngrid.arrange(pInvFroMod, pInvMaxMod, pDifFro, pDifMax, leg,\n             layout_matrix = matrix(c(1, 2, 5, 3, 4, 5), ncol = 3, byrow = T), widths = c(2.5, 2.5, 1.2))\n\n\ngrid.arrange(pInvFro, pInvMax, pInvFroMod, pInvMaxMod, leg,\n             layout_matrix = matrix(c(1, 2, 5, 3, 4, 5), ncol = 3, byrow = T), widths = c(2.5, 2.5, 1.2))\n\ngrid.arrange(pDifFro, pDifMax, leg,\n             layout_matrix = matrix(c(1, 2, 3), ncol = 3, byrow = T), widths = c(2.5, 2.5, 1.2))\n\n\n\n### AIKSD ----------------------------------------------\npAIKSD = ggplot(aiksd, aes(x = Knots, y = Values)) +\n  geom_line(aes(color = Particle, linetype = IS)) +\n  coord_cartesian(ylim = c(0, NA)) +\n  labs(title = \"AIKSD\", x = \"The number of sample points\", y = \"Discrepancy\")\n# labs(x = \"The number of sample points\", y = \"Discrepancy\")\n\npAIKSD\n\n\n# aiksdData = aiksd %>% filter(Dataset == ds)\n# \n# pAIKSD = ggplot(aiksdData, aes(x = Knots, y = Values)) +\n#   geom_line(aes(color = Algorithm)) +\n#   labs(title = \"AIKSD\", x = \"The number of sample points\", y = \"Discrepancy\")\n# \n# pAIKSD\n\n\n\n### B2 and AIKSD ----------------------------------------------\n# Remove the legend\npAIKSD = pAIKSD + theme(legend.position=\"none\")\n\ngrid.arrange(pInvFro, pAIKSD, leg, ncol = 3, widths = c(2.3, 2.3, 1.1))\ngrid.arrange(pInvFroMod, pAIKSD, leg, ncol = 3, widths = c(2.3, 2.3, 1.1))\ngrid.arrange(pDifFro, pAIKSD, leg, ncol = 3, widths = c(2.3, 2.3, 1.1))\n\n\n\n",
    "created" : 1608320006394.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "142758511",
    "id" : "E9BC3708",
    "lastKnownWriteTime" : 1608439791,
    "last_content_update" : 1608439791517,
    "path" : "/storage/work/b/bxk487/diagnostics/ergm/magnolia/plotting.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}